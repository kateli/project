#`http`的缓存机制和原理

##### 1.3.1 `http`报文
`http` 报文就是浏览器和服务器间通信时发送及响应的数据块。

浏览器向服务器请求数据，发送请求（`request`）报文；服务器向浏览器返回数据，返回响应（`response`）报文。

报文信息主要分为两部分：

1.包含属性的首部（`header`）---------- 附加信息（`cookie`，缓存信息等）与缓存相关的规则信息，均包含在header中。

2.包含数据的主体部分（`body`）---------- http请求真正想要传输的部分。

##### 1.3.2 缓存规则解析
为方便理解，我们认为浏览器存在一个缓存数据库，用于存储缓存信息。

在客户端第一次请求数据时，此时缓存数据库中并没有对应的缓存数据，需要请求服务器，服务器返回后，将数据存储至缓存数据库中。

![avatar](../images/http01.png)

`http`缓存有多种规则，根据是否需要重新向服务器端发起请求来分类，将其分为两大类（强制缓存，对比缓存），在详细介绍这两种规则之前，先通过时序图的方式，让大家对这两种规则，有个简单的了解。

已存在缓存数据时，仅基于强制缓存，请求数据的流程如下
![avatar](../images/http02.png)

已存在缓存数据时，仅基于对比缓存，请求数据的流程如下
![avatar](../images/http03.png)

我们可以看到两类缓存规则的不同，强制缓存如果生效，不需要再和服务器发生交互，而对比缓存，不管是否生效，都需要与服务端发生交互。两类缓存规则可以同时存在，强制缓存优先级高于对比缓存，也就是说，当执行强制缓存的规则时，如果缓存生效，则直接使用缓存，不在执行对比缓存规则。
